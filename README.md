初始化综能云
-- 迭代7新增脚本
ALTER TABLE "public"."tb_project_kpi_config"
ADD COLUMN "sort" int8;

COMMENT ON COLUMN "public"."tb_project_kpi_config"."sort" IS '排序';

-- 迭代8新增脚本
CREATE TABLE "public"."tb_project_cnf_electricity_price" (
"id" int8 NOT NULL GENERATED BY DEFAULT AS IDENTITY (
INCREMENT 1
MINVALUE  1
MAXVALUE 9223372036854775807
START 1
),
"project_id" varchar(54) COLLATE "pg_catalog"."default" NOT NULL,
"type" varchar(2) COLLATE "pg_catalog"."default",
"price" numeric(6,4),
"creator" int8,
"create_time" timestamp(6),
"updater" int8,
"update_time" timestamp(6),
"deleted" int2,
"tenant_id" int8,
PRIMARY KEY ("id")
)
;

ALTER TABLE "public"."tb_project_cnf_electricity_price"
OWNER TO "landleaf";

COMMENT ON COLUMN "public"."tb_project_cnf_electricity_price"."id" IS '分时配置id';

COMMENT ON COLUMN "public"."tb_project_cnf_electricity_price"."project_id" IS '项目ID';

COMMENT ON COLUMN "public"."tb_project_cnf_electricity_price"."type" IS '电费类型，见字典ELECTRICITY_PRICE_TYPE';

COMMENT ON COLUMN "public"."tb_project_cnf_electricity_price"."price" IS '电价';

COMMENT ON COLUMN "public"."tb_project_cnf_electricity_price"."creator" IS '创建人';

COMMENT ON COLUMN "public"."tb_project_cnf_electricity_price"."create_time" IS '创建时间';

COMMENT ON COLUMN "public"."tb_project_cnf_electricity_price"."updater" IS '更新人';

COMMENT ON COLUMN "public"."tb_project_cnf_electricity_price"."update_time" IS '更新时间';

COMMENT ON COLUMN "public"."tb_project_cnf_electricity_price"."deleted" IS '是否删除';

COMMENT ON COLUMN "public"."tb_project_cnf_electricity_price"."tenant_id" IS ' 租户ID';

COMMENT ON TABLE "public"."tb_project_cnf_electricity_price" IS '配置表-分时';

-- 插入dict
INSERT INTO "public"."tb_dict_type"("code", "name", "type", "description", "creator", "create_time", "updater", "update_time", "deleted") VALUES ('ELECTRICITY_PRICE_TYPE', '电费配置类型', 1, '电费配置类型,用于区分电费是单价模式或阶梯模式等', 1, '2023-12-25 17:26:18.009934', 1, '2023-12-25 17:26:18.009968', 0);

INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='ELECTRICITY_PRICE_TYPE'), '01', '固定电价', 0, 1, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'ELECTRICITY_PRICE_TYPE');
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='ELECTRICITY_PRICE_TYPE'), '02', '分时电价', 0, 2, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'ELECTRICITY_PRICE_TYPE');

INSERT INTO "public"."tb_project_cnf_electricity_price"("project_id", "type", "price", "creator", "create_time", "updater", "update_time", "deleted", "tenant_id")
select DISTINCT project_id, '02' as type, 0.0 as price, 1 as "creator", now() as create_time, 1 as updater, now() as update_time, 0 as deleted, tenant_id from tb_project_cnf_time_period where deleted=0 and project_id != '';

-- 迭代9新增db脚本
ALTER TABLE "public"."tb_tenant"
ALTER COLUMN "reporting_cycle"  varchar(5) COLLATE "pg_catalog"."default" NOT NULL DEFAULT '0',

COMMENT ON COLUMN "public"."tb_tenant"."reporting_cycle" IS '月报周期';

INSERT INTO "public"."tb_dict_type"("code", "name", "type", "description", "creator", "create_time", "updater", "update_time", "deleted") VALUES ('REPORTING_CYCLE', '月报周期', 1, '月报周期', 1, '2024-04-23 10:06:44', 1, '2024-04-23 10:06:49', 0);
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='REPORTING_CYCLE'), '0', '自然月', 0, 1, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'REPORTING_CYCLE');
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='REPORTING_CYCLE'), '6', '上月6（不含）到本月6', 0, 2, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'REPORTING_CYCLE');
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='REPORTING_CYCLE'), '5', '上月5（不含）到本月5', 0, 3, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'REPORTING_CYCLE');
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='REPORTING_CYCLE'), '4', '上月4（不含）到本月4', 0, 4, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'REPORTING_CYCLE');
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='REPORTING_CYCLE'), '3', '上月3（不含）到本月3', 0, 5, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'REPORTING_CYCLE');
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='REPORTING_CYCLE'), '2', '上月2（不含）到本月2', 0, 6, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'REPORTING_CYCLE');
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='REPORTING_CYCLE'), '1', '上月1（不含）到本月1', 0, 7, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'REPORTING_CYCLE');
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='REPORTING_CYCLE'), '28', '上月28（不含）到本月28', 0, 8, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'REPORTING_CYCLE');
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='REPORTING_CYCLE'), '27', '上月27（不含）到本月27', 0, 9, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'REPORTING_CYCLE');
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='REPORTING_CYCLE'), '26', '上月26（不含）到本月26', 0, 10, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'REPORTING_CYCLE');
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='REPORTING_CYCLE'), '25', '上月25（不含）到本月25', 0, 11, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'REPORTING_CYCLE');
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='REPORTING_CYCLE'), '24', '上月24（不含）到本月24', 0, 12, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'REPORTING_CYCLE');
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='REPORTING_CYCLE'), '23', '上月23（不含）到本月23', 0, 13, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'REPORTING_CYCLE');

CREATE TABLE "public"."tb_rule" (
"id" int8 NOT NULL GENERATED BY DEFAULT AS IDENTITY (
INCREMENT 1
MINVALUE  1
MAXVALUE 9223372036854775807
START 1
),
"biz_rule_id" varchar(5) COLLATE "pg_catalog"."default" NOT NULL,
"name" varchar(128) COLLATE "pg_catalog"."default" NOT NULL DEFAULT ''::character varying,
"rule_desc" varchar(255) COLLATE "pg_catalog"."default" NOT NULL,
"rule_type" varchar(6) COLLATE "pg_catalog"."default" NOT NULL,
"rule_status" varchar(2) COLLATE "pg_catalog"."default" NOT NULL,
"biz_project_id" varchar(10) COLLATE "pg_catalog"."default" NOT NULL,
"creator" int8 NOT NULL DEFAULT 0,
"create_time" timestamp(6) NOT NULL,
"updater" int8 NOT NULL DEFAULT 0,
"update_time" timestamp(6) NOT NULL,
"deleted" int2 NOT NULL DEFAULT 0,
"tenant_id" int8 NOT NULL DEFAULT 0,
PRIMARY KEY ("id")
)
;

ALTER TABLE "public"."tb_rule"
OWNER TO "landleaf";

CREATE INDEX "index_biz_proj_id" ON "public"."tb_rule" USING btree (
"biz_project_id" COLLATE "pg_catalog"."default" "pg_catalog"."text_ops" ASC NULLS LAST
);

CREATE INDEX "index_biz_rule_id" ON "public"."tb_rule" USING btree (
"biz_rule_id" COLLATE "pg_catalog"."default" "pg_catalog"."text_ops" ASC NULLS LAST
);

CREATE INDEX "index_rule_name" ON "public"."tb_rule" USING btree (
"name" COLLATE "pg_catalog"."default" "pg_catalog"."text_ops" ASC NULLS LAST
);

CREATE INDEX "index_tenant_id" ON "public"."tb_rule" USING btree (
"tenant_id" "pg_catalog"."int8_ops" ASC NULLS LAST
);

COMMENT ON COLUMN "public"."tb_rule"."id" IS '规则编号';

COMMENT ON COLUMN "public"."tb_rule"."biz_rule_id" IS '规则的业务编码';

COMMENT ON COLUMN "public"."tb_rule"."name" IS '规则名称';

COMMENT ON COLUMN "public"."tb_rule"."rule_desc" IS '规则描述';

COMMENT ON COLUMN "public"."tb_rule"."rule_type" IS '规则类型，见字典RULE_TYPE';

COMMENT ON COLUMN "public"."tb_rule"."rule_status" IS '规则状态，见字典RYLE_STATUS';

COMMENT ON COLUMN "public"."tb_rule"."biz_project_id" IS '项目id（全局唯一id）';

COMMENT ON COLUMN "public"."tb_rule"."creator" IS '创建者';

COMMENT ON COLUMN "public"."tb_rule"."create_time" IS '创建时间';

COMMENT ON COLUMN "public"."tb_rule"."updater" IS '更新者';

COMMENT ON COLUMN "public"."tb_rule"."update_time" IS '更新时间';

COMMENT ON COLUMN "public"."tb_rule"."deleted" IS '是否删除（0否 1是）';

COMMENT ON COLUMN "public"."tb_rule"."tenant_id" IS '租户id';

CREATE TABLE "public"."tb_rule_trigger" (
"id" int8 NOT NULL GENERATED BY DEFAULT AS IDENTITY (
INCREMENT 1
MINVALUE  1
MAXVALUE 9223372036854775807
START 1
),
"trigger_type" varchar(2) COLLATE "pg_catalog"."default" NOT NULL,
"message_type" varchar(2) COLLATE "pg_catalog"."default" NOT NULL,
"target_biz_prod_id" varchar(50) COLLATE "pg_catalog"."default" NOT NULL DEFAULT ''::character varying,
"target_biz_device_ids" varchar(255) COLLATE "pg_catalog"."default" NOT NULL DEFAULT ''::character varying,
"biz_rule_id" varchar(5) COLLATE "pg_catalog"."default" NOT NULL,
"repeat_time" varchar(128) COLLATE "pg_catalog"."default" NOT NULL DEFAULT ''::character varying,
"repeat_type" varchar(2) COLLATE "pg_catalog"."default" NOT NULL DEFAULT ''::character varying,
"target_time" varchar(32) COLLATE "pg_catalog"."default" NOT NULL DEFAULT ''::character varying,
"creator" int8 NOT NULL DEFAULT 0,
"create_time" timestamp(6) NOT NULL,
"updater" int8 NOT NULL DEFAULT 0,
"update_time" timestamp(6) NOT NULL,
"deleted" int2 NOT NULL DEFAULT 0,
"target_prod_id" int8,
PRIMARY KEY ("id")
)
;

ALTER TABLE "public"."tb_rule_trigger"
OWNER TO "landleaf";

CREATE INDEX "index_biz_rule_id_1" ON "public"."tb_rule_trigger" USING btree (
"biz_rule_id" COLLATE "pg_catalog"."default" "pg_catalog"."text_ops" ASC NULLS LAST
);

CREATE INDEX "index_target_biz_prod_id" ON "public"."tb_rule_trigger" USING btree (
"target_biz_prod_id" COLLATE "pg_catalog"."default" "pg_catalog"."text_ops" ASC NULLS LAST
);

COMMENT ON COLUMN "public"."tb_rule_trigger"."id" IS '规则编号';

COMMENT ON COLUMN "public"."tb_rule_trigger"."trigger_type" IS '触发类型：见字典RULE_TRIGGER_TYPE';

COMMENT ON COLUMN "public"."tb_rule_trigger"."message_type" IS '触发报文类型：见字典TARGET_MESSAGE_TYPE';

COMMENT ON COLUMN "public"."tb_rule_trigger"."target_biz_prod_id" IS '产品业务id';

COMMENT ON COLUMN "public"."tb_rule_trigger"."target_biz_device_ids" IS '触发设备，多个以逗号分隔';

COMMENT ON COLUMN "public"."tb_rule_trigger"."biz_rule_id" IS '规则的业务编码';

COMMENT ON COLUMN "public"."tb_rule_trigger"."repeat_time" IS '重复时间，逗号分隔';

COMMENT ON COLUMN "public"."tb_rule_trigger"."repeat_type" IS '重复类型';

COMMENT ON COLUMN "public"."tb_rule_trigger"."target_time" IS '触发时间';

COMMENT ON COLUMN "public"."tb_rule_trigger"."creator" IS '创建者';

COMMENT ON COLUMN "public"."tb_rule_trigger"."create_time" IS '创建时间';

COMMENT ON COLUMN "public"."tb_rule_trigger"."updater" IS '更新者';

COMMENT ON COLUMN "public"."tb_rule_trigger"."update_time" IS '更新时间';

COMMENT ON COLUMN "public"."tb_rule_trigger"."deleted" IS '是否删除（0否 1是）';

COMMENT ON COLUMN "public"."tb_rule_trigger"."target_prod_id" IS '给前端冗余的产品id';

CREATE TABLE "public"."tb_rule_condition" (
"id" int8 NOT NULL GENERATED BY DEFAULT AS IDENTITY (
INCREMENT 1
MINVALUE  1
MAXVALUE 9223372036854775807
START 1
),
"condition_type" varchar(2) COLLATE "pg_catalog"."default" NOT NULL,
"cor_biz_prod_id" varchar(50) COLLATE "pg_catalog"."default" NOT NULL DEFAULT ''::character varying,
"cor_biz_device_id" varchar(50) COLLATE "pg_catalog"."default" NOT NULL DEFAULT ''::character varying,
"biz_rule_id" varchar(5) COLLATE "pg_catalog"."default" NOT NULL,
"repeat_time" varchar(128) COLLATE "pg_catalog"."default" NOT NULL DEFAULT ''::character varying,
"repeat_type" varchar(2) COLLATE "pg_catalog"."default" NOT NULL DEFAULT ''::character varying,
"judge_time_start" varchar(32) COLLATE "pg_catalog"."default" NOT NULL DEFAULT ''::character varying,
"compare_val" varchar(255) COLLATE "pg_catalog"."default" NOT NULL DEFAULT ''::character varying,
"comparator" varchar(2) COLLATE "pg_catalog"."default" NOT NULL DEFAULT ''::character varying,
"attr_code" varchar(255) COLLATE "pg_catalog"."default" NOT NULL DEFAULT ''::character varying,
"judge_time_end" varchar(32) COLLATE "pg_catalog"."default" NOT NULL DEFAULT ''::character varying,
"creator" int8 NOT NULL DEFAULT 0,
"create_time" timestamp(6) NOT NULL,
"updater" int8 NOT NULL DEFAULT 0,
"update_time" timestamp(6) NOT NULL,
"deleted" int2 NOT NULL DEFAULT 0,
"cor_prod_id" int8,
PRIMARY KEY ("id")
)
;

ALTER TABLE "public"."tb_rule_condition"
OWNER TO "landleaf";

CREATE INDEX "index_biz_device_id" ON "public"."tb_rule_condition" USING btree (
"cor_biz_device_id" COLLATE "pg_catalog"."default" "pg_catalog"."text_ops" ASC NULLS LAST
);

CREATE INDEX "index_biz_prod_id_1" ON "public"."tb_rule_condition" USING btree (
"cor_biz_prod_id" COLLATE "pg_catalog"."default" "pg_catalog"."text_ops" ASC NULLS LAST
);

CREATE INDEX "index_biz_rule_id_2" ON "public"."tb_rule_condition" USING btree (
"biz_rule_id" COLLATE "pg_catalog"."default" "pg_catalog"."text_ops" ASC NULLS LAST
);

COMMENT ON COLUMN "public"."tb_rule_condition"."id" IS '规则编号';

COMMENT ON COLUMN "public"."tb_rule_condition"."condition_type" IS '条件类型：见字典RULE_CONDITION_TYPE';

COMMENT ON COLUMN "public"."tb_rule_condition"."cor_biz_prod_id" IS '关联产品业务id';

COMMENT ON COLUMN "public"."tb_rule_condition"."cor_biz_device_id" IS '关联设备';

COMMENT ON COLUMN "public"."tb_rule_condition"."biz_rule_id" IS '规则的业务编码';

COMMENT ON COLUMN "public"."tb_rule_condition"."repeat_time" IS '重复时间，逗号分隔';

COMMENT ON COLUMN "public"."tb_rule_condition"."repeat_type" IS '重复类型';

COMMENT ON COLUMN "public"."tb_rule_condition"."judge_time_start" IS '触发时间开始';

COMMENT ON COLUMN "public"."tb_rule_condition"."compare_val" IS '比较值';

COMMENT ON COLUMN "public"."tb_rule_condition"."comparator" IS '比较符号，见字典COMPARATOR';

COMMENT ON COLUMN "public"."tb_rule_condition"."attr_code" IS '属性code';

COMMENT ON COLUMN "public"."tb_rule_condition"."judge_time_end" IS '触发时间结束';

COMMENT ON COLUMN "public"."tb_rule_condition"."creator" IS '创建者';

COMMENT ON COLUMN "public"."tb_rule_condition"."create_time" IS '创建时间';

COMMENT ON COLUMN "public"."tb_rule_condition"."updater" IS '更新者';

COMMENT ON COLUMN "public"."tb_rule_condition"."update_time" IS '更新时间';

COMMENT ON COLUMN "public"."tb_rule_condition"."deleted" IS '是否删除（0否 1是）';

COMMENT ON COLUMN "public"."tb_rule_condition"."cor_prod_id" IS '给前端冗余的产品id';

CREATE TABLE "public"."tb_rule_action" (
"id" int8 NOT NULL GENERATED BY DEFAULT AS IDENTITY (
INCREMENT 1
MINVALUE  1
MAXVALUE 9223372036854775807
START 1
),
"action_type" varchar(2) COLLATE "pg_catalog"."default" NOT NULL,
"action_biz_prod_id" varchar(50) COLLATE "pg_catalog"."default" NOT NULL DEFAULT ''::character varying,
"action_biz_device_id" varchar(50) COLLATE "pg_catalog"."default" NOT NULL DEFAULT ''::character varying,
"biz_rule_id" varchar(5) COLLATE "pg_catalog"."default" NOT NULL,
"creator" int8 NOT NULL DEFAULT 0,
"create_time" timestamp(6) NOT NULL,
"updater" int8 NOT NULL DEFAULT 0,
"update_time" timestamp(6) NOT NULL,
"deleted" int2 NOT NULL DEFAULT 0,
"alarm_code" varchar(50) COLLATE "pg_catalog"."default" NOT NULL DEFAULT ''::character varying,
"alarm_trigger_level" varchar(50) COLLATE "pg_catalog"."default" NOT NULL DEFAULT ''::character varying,
"alarm_relapse_level" varchar(50) COLLATE "pg_catalog"."default" NOT NULL DEFAULT ''::character varying,
"alarm_trigger_confirm_type" varchar(50) COLLATE "pg_catalog"."default" NOT NULL DEFAULT ''::character varying,
"alarm_trigger_desc" varchar(50) COLLATE "pg_catalog"."default" NOT NULL DEFAULT ''::character varying,
"alarm_relapse_desc" varchar(50) COLLATE "pg_catalog"."default" NOT NULL DEFAULT ''::character varying,
"alarm_relapse_confirm_type" varchar(50) COLLATE "pg_catalog"."default" NOT NULL DEFAULT ''::character varying,
"service_id" int8 NOT NULL DEFAULT 0,
"service_parameter" jsonb NOT NULL DEFAULT '[]'::json,
"service_sending_interval" int4 NOT NULL DEFAULT 0,
"action_prod_id" int8,
PRIMARY KEY ("id")
)
;

ALTER TABLE "public"."tb_rule_action"
OWNER TO "landleaf";

CREATE INDEX "index_biz_device_id_2" ON "public"."tb_rule_action" USING btree (
"action_biz_device_id" COLLATE "pg_catalog"."default" "pg_catalog"."text_ops" ASC NULLS LAST
);

CREATE INDEX "index_biz_prod_id_3" ON "public"."tb_rule_action" USING btree (
"action_biz_prod_id" COLLATE "pg_catalog"."default" "pg_catalog"."text_ops" ASC NULLS LAST
);

CREATE INDEX "index_biz_rule_id_3" ON "public"."tb_rule_action" USING btree (
"biz_rule_id" COLLATE "pg_catalog"."default" "pg_catalog"."text_ops" ASC NULLS LAST
);

COMMENT ON COLUMN "public"."tb_rule_action"."id" IS '规则编号';

COMMENT ON COLUMN "public"."tb_rule_action"."action_type" IS '动作类型：见字典RULE_ACTION_TYPE';

COMMENT ON COLUMN "public"."tb_rule_action"."action_biz_prod_id" IS '执行动作的产品业务id';

COMMENT ON COLUMN "public"."tb_rule_action"."action_biz_device_id" IS '执行动作的设备';

COMMENT ON COLUMN "public"."tb_rule_action"."biz_rule_id" IS '规则的业务编码';

COMMENT ON COLUMN "public"."tb_rule_action"."creator" IS '创建者';

COMMENT ON COLUMN "public"."tb_rule_action"."create_time" IS '创建时间';

COMMENT ON COLUMN "public"."tb_rule_action"."updater" IS '更新者';

COMMENT ON COLUMN "public"."tb_rule_action"."update_time" IS '更新时间';

COMMENT ON COLUMN "public"."tb_rule_action"."deleted" IS '是否删除（0否 1是）';

COMMENT ON COLUMN "public"."tb_rule_action"."alarm_code" IS '告警CODE';

COMMENT ON COLUMN "public"."tb_rule_action"."alarm_trigger_level" IS '告警触发等级 数据字典（ALARM_LEVEL）';

COMMENT ON COLUMN "public"."tb_rule_action"."alarm_relapse_level" IS '告警复归等级 数据字典（ALARM_LEVEL）';

COMMENT ON COLUMN "public"."tb_rule_action"."alarm_trigger_confirm_type" IS '告警触发确认方式 数据字典（ALARM_CONFIRM_TYPE）';

COMMENT ON COLUMN "public"."tb_rule_action"."alarm_trigger_desc" IS '告警触发描述';

COMMENT ON COLUMN "public"."tb_rule_action"."alarm_relapse_desc" IS '告警复归描述';

COMMENT ON COLUMN "public"."tb_rule_action"."alarm_relapse_confirm_type" IS '告警复归确认方式 数据字典（ALARM_CONFIRM_TYPE）';

COMMENT ON COLUMN "public"."tb_rule_action"."service_id" IS '服务id';

COMMENT ON COLUMN "public"."tb_rule_action"."service_parameter" IS '服务参数';

COMMENT ON COLUMN "public"."tb_rule_action"."service_sending_interval" IS '服务下发间隔时间';

COMMENT ON COLUMN "public"."tb_rule_action"."action_prod_id" IS '给前端冗余的产品id';

CREATE SEQUENCE biz_id_rule_seq START 1;

INSERT INTO "public"."tb_dict_type"("code", "name", "type", "description", "creator", "create_time", "updater", "update_time", "deleted") VALUES
('COMPARATOR_TYPE', '比较符配置', 1, '值的比较符的配置', 1, '2023-12-25 17:26:18.009934', 1, '2023-12-25 17:26:18.009968', 0);

INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='COMPARATOR_TYPE'), '01', '=', 0, 1, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'COMPARATOR_TYPE');
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='COMPARATOR_TYPE'), '02', '≠', 0, 2, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'COMPARATOR_TYPE');
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='COMPARATOR_TYPE'), '03', '≥', 0, 3, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'COMPARATOR_TYPE');
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='COMPARATOR_TYPE'), '04', '≤', 0, 4, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'COMPARATOR_TYPE');
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='COMPARATOR_TYPE'), '05', '>', 0, 5, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'COMPARATOR_TYPE');
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='COMPARATOR_TYPE'), '06', '<', 0, 6, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'COMPARATOR_TYPE');


INSERT INTO "public"."tb_dict_type"("code", "name", "type", "description", "creator", "create_time", "updater", "update_time", "deleted") VALUES
('REPEAT_TYPE', '重复类型', 1, '重复类型', 1, '2023-12-25 17:26:18.009934', 1, '2023-12-25 17:26:18.009968', 0);
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='REPEAT_TYPE'), '01', '按周重复', 0, 1, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'REPEAT_TYPE');
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='REPEAT_TYPE'), '02', '按月重复', 0, 2, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'REPEAT_TYPE');


INSERT INTO "public"."tb_dict_type"("code", "name", "type", "description", "creator", "create_time", "updater", "update_time", "deleted") VALUES
('RULE_ACTION_TYPE', '规则的执行类型', 1, '规则的执行类型', 1, '2023-12-25 17:26:18.009934', 1, '2023-12-25 17:26:18.009968', 0);
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='RULE_ACTION_TYPE'), '01', '规则告警', 0, 1, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'RULE_ACTION_TYPE');
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='RULE_ACTION_TYPE'), '02', '控制命令', 0, 2, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'RULE_ACTION_TYPE');

INSERT INTO "public"."tb_dict_type"("code", "name", "type", "description", "creator", "create_time", "updater", "update_time", "deleted") VALUES
('RULE_CONDITION_TYPE', '规则的条件类型', 1, '规则的条件类型', 1, '2023-12-25 17:26:18.009934', 1, '2023-12-25 17:26:18.009968', 0);
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='RULE_CONDITION_TYPE'), '01', '时间条件', 0, 1, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'RULE_CONDITION_TYPE');
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='RULE_CONDITION_TYPE'), '02', '设备条件', 0, 2, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'RULE_CONDITION_TYPE');

INSERT INTO "public"."tb_dict_type"("code", "name", "type", "description", "creator", "create_time", "updater", "update_time", "deleted") VALUES
('RULE_STATUS', '规则可用状态', 1, '规则可用状态', 1, '2023-12-25 17:26:18.009934', 1, '2023-12-25 17:26:18.009968', 0);
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='RULE_STATUS'), '01', '启用', 0, 1, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'RULE_STATUS');
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='RULE_STATUS'), '02', '停用', 0, 2, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'RULE_STATUS');

INSERT INTO "public"."tb_dict_type"("code", "name", "type", "description", "creator", "create_time", "updater", "update_time", "deleted") VALUES
('RULE_TRIGGER_TYPE', '规则触发类型', 1, '规则触发类型', 1, '2023-12-25 17:26:18.009934', 1, '2023-12-25 17:26:18.009968', 0);
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='RULE_TRIGGER_TYPE'), '01', '报文触发', 0, 1, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'RULE_TRIGGER_TYPE');
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='RULE_TRIGGER_TYPE'), '02', '时间触发', 0, 2, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'RULE_TRIGGER_TYPE');

INSERT INTO "public"."tb_dict_type"("code", "name", "type", "description", "creator", "create_time", "updater", "update_time", "deleted") VALUES
('RULE_TYPE', '规则类型', 1, '规则类型', 1, '2023-12-25 17:26:18.009934', 1, '2023-12-25 17:26:18.009968', 0);
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='RULE_TYPE'), '01', '告警规则', 0, 1, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'RULE_TYPE');
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='RULE_TYPE'), '02', '指令规则', 0, 2, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'RULE_TYPE');

INSERT INTO "public"."tb_dict_type"("code", "name", "type", "description", "creator", "create_time", "updater", "update_time", "deleted") VALUES
('TARGET_MESSAGE_TYPE', '规则报文类型', 1, '规则报文类型', 1, '2023-12-25 17:26:18.009934', 1, '2023-12-25 17:26:18.009968', 0);
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='TARGET_MESSAGE_TYPE'), '01', '属性报文', 0, 1, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'TARGET_MESSAGE_TYPE');
INSERT INTO "public"."tb_dict_data"("dict_id", "value", "label", "status", "sort", "is_default", "creator", "create_time", "updater", "update_time", "deleted", "dict_code") VALUES (
(select id from tb_dict_type where code='TARGET_MESSAGE_TYPE'), '02', '事件报文', 0, 2, 0, 1, '2023-07-26 17:58:05.786988', 1, '2024-02-28 13:32:21.864892', 0, 'TARGET_MESSAGE_TYPE');


-- 迭代10新增脚本
CREATE TABLE "public"."tb_unconfirmed_event" (
"id" int8 NOT NULL GENERATED BY DEFAULT AS IDENTITY (
INCREMENT 1
MINVALUE  1
MAXVALUE 9223372036854775807
START 1
),
"event_id" varchar(50) COLLATE "pg_catalog"."default" NOT NULL,
"event_time" timestamp(6) NOT NULL,
"alarm_obj_type" varchar(255) COLLATE "pg_catalog"."default" NOT NULL,
"obj_id" varchar(255) COLLATE "pg_catalog"."default",
"project_biz_id" varchar(255) COLLATE "pg_catalog"."default" NOT NULL,
"alarm_biz_id" varchar(255) COLLATE "pg_catalog"."default" NOT NULL,
"alarm_code" varchar(255) COLLATE "pg_catalog"."default" NOT NULL,
"alarm_type" varchar(255) COLLATE "pg_catalog"."default" NOT NULL,
"alarm_level" varchar(255) COLLATE "pg_catalog"."default" NOT NULL,
"alarm_desc" varchar(255) COLLATE "pg_catalog"."default" NOT NULL,
"alarm_status" varchar(255) COLLATE "pg_catalog"."default" NOT NULL,
"creator" int8 NOT NULL DEFAULT 0,
"create_time" timestamp(6) NOT NULL,
"updater" int8 NOT NULL DEFAULT 0,
"update_time" timestamp(6) NOT NULL,
"deleted" int2 NOT NULL DEFAULT 0,
"tenant_id" int8 NOT NULL,
"event_type" varchar(255) COLLATE "pg_catalog"."default" NOT NULL,
PRIMARY KEY ("id")
)
;

ALTER TABLE "public"."tb_unconfirmed_event"
OWNER TO "landleaf";

CREATE INDEX "index_alarm_type" ON "public"."tb_unconfirmed_event" USING hash (
"alarm_type" COLLATE "pg_catalog"."default" "pg_catalog"."text_ops"
);

CREATE INDEX "index_event_id" ON "public"."tb_unconfirmed_event" USING btree (
"event_id" COLLATE "pg_catalog"."default" "pg_catalog"."text_ops" ASC NULLS LAST
);

CREATE INDEX "index_obj_id" ON "public"."tb_unconfirmed_event" USING btree (
"obj_id" COLLATE "pg_catalog"."default" "pg_catalog"."text_ops" ASC NULLS LAST
);

CREATE INDEX "index_project_biz_id" ON "public"."tb_unconfirmed_event" USING btree (
"project_biz_id" COLLATE "pg_catalog"."default" "pg_catalog"."text_ops" ASC NULLS LAST
);

CREATE INDEX "index_tenant_id" ON "public"."tb_unconfirmed_event" USING btree (
"tenant_id" "pg_catalog"."int8_ops" ASC NULLS LAST
);

COMMENT ON COLUMN "public"."tb_unconfirmed_event"."id" IS 'id';

COMMENT ON COLUMN "public"."tb_unconfirmed_event"."event_id" IS '事件id';

COMMENT ON COLUMN "public"."tb_unconfirmed_event"."event_time" IS '事件发生时间';

COMMENT ON COLUMN "public"."tb_unconfirmed_event"."alarm_obj_type" IS '告警对象类型 数据字典（ALARM_OBJ_TYPE）';

COMMENT ON COLUMN "public"."tb_unconfirmed_event"."obj_id" IS '告警对象id';

COMMENT ON COLUMN "public"."tb_unconfirmed_event"."project_biz_id" IS '所属项目id';

COMMENT ON COLUMN "public"."tb_unconfirmed_event"."alarm_biz_id" IS '告警业务id';

COMMENT ON COLUMN "public"."tb_unconfirmed_event"."alarm_code" IS '告警码';

COMMENT ON COLUMN "public"."tb_unconfirmed_event"."alarm_type" IS '告警类型 数据字典（ALARM_TYPE）';

COMMENT ON COLUMN "public"."tb_unconfirmed_event"."alarm_level" IS '告警等级 数据字典（ALARM_LEVEL）';

COMMENT ON COLUMN "public"."tb_unconfirmed_event"."alarm_desc" IS '告警描述';

COMMENT ON COLUMN "public"."tb_unconfirmed_event"."alarm_status" IS '告警状态 数据字典（ALARM_STATUS）';

COMMENT ON COLUMN "public"."tb_unconfirmed_event"."creator" IS '创建者';

COMMENT ON COLUMN "public"."tb_unconfirmed_event"."create_time" IS '创建时间';

COMMENT ON COLUMN "public"."tb_unconfirmed_event"."updater" IS '更新者';

COMMENT ON COLUMN "public"."tb_unconfirmed_event"."update_time" IS '更新时间';

COMMENT ON COLUMN "public"."tb_unconfirmed_event"."deleted" IS '是否删除（0否 1是）';

COMMENT ON COLUMN "public"."tb_unconfirmed_event"."tenant_id" IS '租户id';

COMMENT ON COLUMN "public"."tb_unconfirmed_event"."event_type" IS '事件类型';

COMMENT ON TABLE "public"."tb_unconfirmed_event" IS '历史事件表';

INSERT INTO "public"."tb_mail"("id", "type", "format", "creator", "create_time", "updater", "update_time", "deleted") VALUES (100005, 8, '<p>您好！</p><p> &nbsp; &nbsp;系统授权还有%s天过期，请尽快处理！</p><p> &nbsp; &nbsp;<span style="color: rgb(191, 191, 191);">本邮件为系统邮件，请不要回复。</span></p><p><img src="%s" alt="朗绿.png" data-href="" style=""/></p>', 1, '2024-06-14 16:34:37', 1, '2024-06-14 16:34:40', 0);
